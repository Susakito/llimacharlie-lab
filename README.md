<h1 align="center">Limacharlie</h1>

<p align="center">
  <img src="path/to/project-logo.png" alt="Project Logo" width="200" height="200">
</p>



<p align="center">
  <a href="#installation">Installation</a> •
  <a href="#limacharlie">Limacharlie</a> •
  <a href="#usage">Usage</a> •
  <a href="#contributing">Contributing</a> •
  <a href="#license">License</a>
</p>


## About
<p>This repository demonstrates how to utilize LimaCharlie as a SIEM, a powerful endpoint security platform, to monitor and analyze payloads using two virtual machines (Mint and Ubuntu Server 22.04.1). By leveraging LimaCharlie's advanced features and capabilities, you can effectively monitor the behavior of payloads in a secure and controlled environment.</p>


### Installation

<h1>Installing Limacharlie on Blue Team</h1>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/c47bfd47-8054-4828-b9a1-f6dad420f039)
<p>Create a organization</p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/6473730e-b6f0-49e5-9d61-f56e9b75f362)
<p>Name your ogranization. Pick the region residency of the data. Note that each region's data privacy law differs from one another. Disable demo configuration. Select "Extended Detection & Response Standard" as the template </p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/601293f2-d7d4-4eea-87fb-0fed7d115ba1)
<p>Select "Add Sensor"</p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/a1d0782a-a40f-413c-9813-a81c70d73d64)
<p>In this lab, the sensor will be isntalled on a Mint OS absed on Linux</p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/4bccedc1-dacd-41ff-b2dc-9c1b1966c6c4)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/9ee41749-34f8-4cd4-a901-f543cbfab872)
<p>Create a new key for the installation and add a description and optionally a tag to easily filter data.</p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/78a50ca3-2bca-4587-a709-6dfcb66738f0)
<p>Select the new key</p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/8d3760ea-9308-4854-8fd0-575f99374ee9)
<p> Choose "x86-64.deb" and download the installer</p>

![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/6c5e7a8c-e1aa-4d86-b256-5e2ac73b6469)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/52597edf-b0a6-4a5d-b54c-cc4881b63ed6)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/074af82e-8cf3-4e8f-929b-e17d94c3e9a2)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/549ee802-02c9-4106-8e7e-311041d5c365)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/fa62c934-3a7a-471d-90ef-f0e61fcb923d)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/dd0e4367-8455-4528-b9c6-43cc13f0dbce)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/12786c30-7030-4975-a919-480dd4b7e1f3)

UBUNTU
SYSMON
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/797e7fbf-148a-4335-8054-6e6aad35b14a)



SLIVER
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/d7db6f66-0eb1-47a5-925a-1c1940184766)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/0ddc8d2b-3f7b-4bb1-9bcc-7b7f105be593)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/68e74834-cb8b-4706-8f86-538da6871ce0)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/c7a01e04-be31-4a8f-8c27-1dacfb37a17c)

************************************PART2************************************
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/63ca67e7-782a-464f-a093-25f8775f842d)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/f0b43c0e-355d-4457-8a82-7dac413152ad)
</br>

sliver windows paylaod
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/aad6a1f8-3d83-4ccb-8a82-e8db899c7a50)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/2e3a79ae-a4cd-4967-90d7-e56b71fda5c9)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/3527ce96-d2ed-4a02-93a8-d0c39cca190d)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/3fece686-83d3-453c-a3ca-c886ba53f6cb)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/bb9ad550-3e39-4757-b92d-9d12941f0e5a)
</br>

//////sliver linux payload//////////
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/ea1e040b-bae5-4877-96de-27212b9c72da)
generate payload
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/a901aa78-565f-45eb-9a74-e1e93ca598d7)
check paylaod create
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/7811d6be-a32a-41dd-8c83-5823c6901423)
this is just a way to deliver the malware from host to target
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/0e0b31da-bc8e-4b83-bfe1-70eb615c777a)
retrived malware using curl
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/7064182c-516d-40e6-a63c-647aa5dce249)
moved the malware to downloads folder
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/c0470c20-8ced-4456-8dd3-aba8d3715d30)
started sliver server to catch callback
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/73dd5f1d-2158-417d-9789-9a1a91ca8d09)
made the malware executable
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/9a7506f7-ab40-4dba-a6b3-349d550d129b)
catched the session


//////////using sliver//////////////////////////////
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/b7ed10e0-1200-433b-abe7-a71cbffad393)
use the new c2 session
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/1412f372-2f26-4126-8712-ada1b46a5557)
victim info
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/1e79d1a9-08a7-4a81-a7dd-f6bcba6e42cf)
whoami
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/d0372de8-e8f1-46cc-a43a-65531e3c87fe)
where malware was executed in the victim machine
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/e0afd84c-a660-47c7-9335-01f7af2d79ba)
netstat victim machine
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/7653977c-ae08-4710-abfc-e64113db71e8)
running procces in the victim machine


/////limacharlie during c2 payload////////////
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/7bb4f6f0-df1c-4989-8194-4e3c4b12b116)
the process of the payload can be found in the proccess tab
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/81752ffb-d782-4d6f-b464-46385cf46cf1)
same in the network tab
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/208b584b-50c2-4f89-a36f-255e0dd29df7)
Destination is going to the adversary's ip address which is our ubutntu VM
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/6d3e8282-72ce-4bc0-8c71-3be4e88ced0a)
in the timeline applying the filter PROUD_KILOGRAM, when can see when the new proccess was created
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/c1686fca-3954-4d79-a1e7-559355f3d9a3)
the malware was downloaded using curl
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/15eccf73-a182-4ab1-8552-f16b89bc2a3e)
malware is executed
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/8563aa95-9452-432f-bb4f-94eb210e979c)
connection was made to 192.168.254.130 after malware execution
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/3a7971af-3cf8-4fc5-9d25-846810d510af)
path of the malware
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/c538d06f-aca8-4345-a1a8-0fd0c34359bd)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/31f0a2ca-854e-42e2-b333-ae7cfecfee8a)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/64d1321b-56f8-420f-baea-5846894366e9)
navigate using filesystem and check filehash


************************************PART3************************************
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/33069d80-ec13-4327-b11a-563d58aac345)
downloaded passwd file from victim to attack machine
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/3cf401b9-a83b-437d-8392-44fde9fe7803)
reverse shell access

///////////////////////limacharlie////////////////////////////////////
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/56ae0d81-4d16-455b-bb06-186cf6465c8d)
added rule where in PROUD_KILOGRAM.exe is executed, a report will be generated
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/b8dd8cf9-87ad-4681-b18b-dec81beb8f0f)
save and enable
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/9f60c3d9-e56a-4bb5-a8cb-46cab4c5c9df)
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/375d64d0-0f91-4338-ba78-43a532c2fce1)
report generated
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/f2f4b34a-3959-42ca-9e8a-ab06c584f4d7)
deleted snapshot to generate report on limacharlie. is command is commonly used to cover tracks of malicous activity. 
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/e1246777-a800-4222-84fe-78e05f40fa60)
view in timeline and create a DnR rule
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/4e673004-af11-4762-b2bc-881b3ec5947c)
craete snapshot kill rule
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/f2f4b34a-3959-42ca-9e8a-ab06c584f4d7)
rerun snapshot deletion
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/a4cd63bc-05f9-444c-b9ec-93845ba1fe85)
shell is killed
![image](https://github.com/Susakito/llimacharlie-lab/assets/75007981/0b4ee182-87e6-4250-973b-250206688300)
rule is detected






















```shell
$ npm install
